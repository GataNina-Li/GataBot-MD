import axios from 'axios'
import cheerio from 'cheerio'
import fetch from 'node-fetch'
let handler = async (m, { conn, args, usedPrefix, command }) => {
if (!args[0]) throw `${lenguajeGB['smsAvisoMG']()}${mid.smsInsta2}\n*${usedPrefix + command} gata_dios*`
try {
const apiUrl = `${apis}/tools/igstalk?username=${encodeURIComponent(args[0])}`;
const apiResponse = await fetch(apiUrl);
const delius = await apiResponse.json();
if (!delius || !delius.data) return m.react("âŒ");
const profile = delius.data;
const txt = `â”ƒ ð“ƒ  *${gt} ${vs}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ 
â”ƒ ${mid.user}
â”ƒ ${profile.username}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.name}
â”ƒ ${profile.full_name}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.smsinsta4} 
â”ƒ ${profile.biography}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ *VERIFICADOS*: 
â”ƒ ${profile.verified ? 'SÃ­' : 'No'}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ *CUENTA PRIVADA*: 
â”ƒ ${profile.private ? 'SÃ­' : 'No'}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.smsinsta1}
â”ƒ ${profile.followers}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.smsinsta2}
â”ƒ ${profile.following}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.smsinsta3} 
â”ƒ ${profile.posts}
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ *URL*: 
â”ƒ ${profile.url}`;
await conn.sendFile(m.chat, profile.profile_picture, 'insta_profile.jpg', txt, m, null, fake);
} catch (error) {
try {
const {key} = await conn.sendMessage(m, {text: wait})
await conn.sendMessage(m, {text: waitt, edit: key})
await conn.sendMessage(m, {text: waittt, edit: key})
await conn.sendMessage(m, {text: waitttt, edit: key})
let res = await igstalk(args[0].replace(/^@/, ''))
let res2 = await fetch(`https://api.lolhuman.xyz/api/stalkig/${args[0].replace(/^@/, '')}?apikey=${lolkeysapi}`)
let res3 = await res2.json()
let json = JSON.parse(JSON.stringify(res))
let iggs = `â”ƒ ð“ƒ  *${gt} ${vs}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ 
â”ƒ  ${mid.name}
â”ƒ *${json.username}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ  ${mid.user}
â”ƒ *${json.fullname}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.smsYT4}
â”ƒ *https://instagram.com/${json.username.replace(/^@/, '')}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ${mid.smsinsta1}
â”ƒ *${json.followers}* 
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ  ${mid.smsinsta2}
â”ƒ *${json.following}* 
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ 
â”ƒ  ${mid.smsinsta3}
â”ƒ *${json.post}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ  ${mid.smsinsta4}
â”ƒ *${json.bio}*`.trim() 
let aa = `${res3.result.photo_profile || res.profile}`
await conn.sendFile(m.chat, aa, 'error.jpg', iggs, m)
conn.reply(m.chat, `${lenguajeGB['smsAvisoIIG']()} *${mid.smsinfo}*`, m, {contextInfo: { externalAdReply :{ mediaUrl: null, mediaType: 1, description: null, 
title: 'ð™‚ð™–ð™©ð™–ð˜½ð™¤ð™©-ð™ˆð˜¿ | ð™‚ð™–ð™©ð™– ð˜¿ð™žð™¤ð™¨',
body: 'Super Bot WhatsApp',         
previewType: 0, thumbnail: gataMenu,
sourceUrl: md}}})
} catch (e) {
await conn.reply(m.chat, `${lenguajeGB['smsMalError3']()}#report ${lenguajeGB['smsMensError2']()} ${usedPrefix + command}\n\n${wm}`, m)
console.log(`â—â— ${lenguajeGB['smsMensError2']()} ${usedPrefix + command} â—â—`)
console.log(e)
handler.money = false
}}}
handler.help = ['igstalk'].map(v => v + ' <username>')
handler.tags = ['downloader']
handler.command = /^(igstalk|verig|igver)$/i
handler.money = 150
//handler.level = 3
//handler.register = true
export default handler

async function igstalk(Username) {
return new Promise((resolve, reject) => {
axios.get('https://dumpor.com/v/'+Username, {
headers: { "cookie": "_inst_key=SFMyNTY.g3QAAAABbQAAAAtfY3NyZl90b2tlbm0AAAAYWGhnNS1uWVNLUU81V1lzQ01MTVY2R0h1.fI2xB2dYYxmWqn7kyCKIn1baWw3b-f7QvGDfDK2WXr8", "user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36" }}).then(res => {
const $ = cheerio.load(res.data)
const result = {
profile: $('#user-page > div.user > div.row > div > div.user__img').attr('style').replace(/(background-image: url\(\'|\'\);)/gi, ''),
fullname: $('#user-page > div.user > div > div.col-md-4.col-8.my-3 > div > a > h1').text(),
username: $('#user-page > div.user > div > div.col-md-4.col-8.my-3 > div > h4').text(),
post: $('#user-page > div.user > div > div.col-md-4.col-8.my-3 > ul > li:nth-child(1)').text().replace(' Posts',''),
followers: $('#user-page > div.user > div > div.col-md-4.col-8.my-3 > ul > li:nth-child(2)').text().replace(' Followers',''),
following: $('#user-page > div.user > div > div.col-md-4.col-8.my-3 > ul > li:nth-child(3)').text().replace(' Following',''),
bio: $('#user-page > div.user > div > div.col-md-5.my-3 > div').text()}
resolve(result)})})}


/*import { instagramStalk } from '@bochilteam/scraper'

let handler= async (m, { args, usedPrefix, command }) => {
if (!args[0]) throw `${lenguajeGB['smsAvisoMG']()}ð™„ð™‰ð™‚ð™ð™€ð™Žð™€ ð™€ð™‡ ð™ð™Žð™ð˜¼ð™ð™„ð™Š ð˜¿ð™€ ð˜¼ð™‡ð™‚ð™ð™„ð™€ð™‰ ð˜¿ð™€ ð™„ð™‰ð™Žð™ð˜¼ð™‚ð™ð˜¼ð™ˆ\nð™€ð™…ð™€ð™ˆð™‹ð™‡ð™Š\n*${usedPrefix + command} gatadios*\n\nð™€ð™‰ð™ð™€ð™ ð™„ð™‰ð™Žð™ð˜¼ð™‚ð™ð˜¼ð™ˆ ð™ð™Žð™€ð™ð™‰ð˜¼ð™ˆð™€\nð™€ð™“ð˜¼ð™ˆð™‹ð™‡ð™€\n*${usedPrefix + command} gata_dios*`
const {
username,
name,
description,
followersH,
followingH,
postsH,
} = await instagramStalk(args[0])
m.reply(`
â”ƒ ð“ƒ  *${gt} ${vs}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ð™‰ð™Šð™ˆð˜½ð™ð™€ | ð™‰ð˜¼ð™ˆð™€
â”ƒ *${name}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ð™ð™Žð™ð˜¼ð™ð™„ð™Š(ð˜¼) | ð™ð™Žð™€ð™
â”ƒ *${username}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ð™€ð™‰ð™‡ð˜¼ð˜¾ð™€ | ð™‡ð™„ð™‰ð™†
â”ƒ *https://instagram.com/${username.replace(/^@/, '')}*
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ð™Žð™€ð™‚ð™ð™„ð˜¿ð™Šð™ð™€ð™Ž | ð™ð™Šð™‡ð™‡ð™Šð™’ð™€ð™ð™Ž 
â”ƒ *${followersH}* 
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ð™Žð™€ð™‚ð™ð™„ð˜¿ð™Šð™Ž | ð™ð™Šð™‡ð™‡ð™Šð™’ð™„ð™‰ð™‚
â”ƒ *${followingH}* 
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ 
â”ƒ ð™‹ð™ð˜½ð™‡ð™„ð˜¾ð˜¼ð˜¾ð™„ð™Šð™‰ð™€ð™Ž | ð™‹ð™Šð™Žð™ð™Ž
â”ƒ *${postsH}* 
â”ƒâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
â”ƒ ð˜½ð™„ð™Šð™‚ð™ð˜¼ð™Ãð˜¼ | ð˜¿ð™€ð™Žð˜¾ð™ð™„ð™‹ð™ð™„ð™Šð™‰
â”ƒ *${description}*
`.trim()) 
  
  let info = `ðŸ’– *InfÃ³rmate sobre las Novedades y recuerda tener la Ãºltima versiÃ³n.*\n\nðŸ’ *Find out about what's new and remember to have the latest version.*
  `
 conn.sendButton(m.chat, info, `ð™‚ð˜¼ð™ð˜¼ ð˜¿ð™„ð™Šð™Ž - ð˜¼ð™Žð™„ð™Žð™ð™€ð™‰ð˜¾ð™„ð˜¼\n${asistencia}\n\n`, [
['ð™ˆð™šð™£ð™ª ð˜¿ð™šð™¨ð™˜ð™–ð™§ð™œð™–ð™¨ ðŸŒ€', '#descargasmenu'],
['ð™ˆð™šð™£ð™ª ð˜¾ð™¤ð™¢ð™¥ð™¡ð™šð™©ð™¤ | ð™ð™ªð™¡ð™¡ ð™ˆð™šð™£ð™ª âœ¨', '.allmenu'],
['ð™‘ð™¤ð™¡ð™«ð™šð™§ ð™–ð™¡ ð™ˆð™šð™£ð™ªÌ | ð˜½ð™–ð™˜ð™  ð™©ð™¤ ð™ˆð™šð™£ð™ª â˜˜ï¸', '/menu']], m)
 /*.trim()
  
await conn.sendHydrated(m.chat, info, wm, null, ig, 'ð™„ð™£ð™¨ð™©ð™–ð™œð™§ð™–ð™¢', null, null, [
['ð™ˆð™šð™£ð™ª ð˜¿ð™šð™¨ð™˜ð™–ð™§ð™œð™–ð™¨ ðŸŒ€', '#descargasmenu'],
['ð™ˆð™šð™£ð™ª ð˜¾ð™¤ð™¢ð™¥ð™¡ð™šð™©ð™¤ | ð™ð™ªð™¡ð™¡ ð™ˆð™šð™£ð™ª âœ¨', '.allmenu'],
['ð™‘ð™¤ð™¡ð™«ð™šð™§ ð™–ð™¡ ð™ˆð™šð™£ð™ªÌ | ð˜½ð™–ð™˜ð™  ð™©ð™¤ ð™ˆð™šð™£ð™ª â˜˜ï¸', '/menu']
], m,)  
  
}
handler.help = ['igstalk'].map(v => v + ' <username>')
handler.tags = ['downloader']
handler.command = /^(igstalk|verig|igver)$/i
handler.exp = 80
export default handler*/

